<!DOCTYPE html>
<html lang="es">
<head>
<!-- ConfiguraciÃ³n CORS para GitHub Pages -->
<meta http-equiv="Content-Security-Policy" content="default-src 'self' https:; script-src 'self' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://script.google.com 'unsafe-inline'; connect-src https://script.google.com https://script.googleusercontent.com;">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simulador HGW</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
  <style>
    body { font-family: 'Poppins', sans-serif; background-color: #0f0f0f; color: #e0ffe0; margin: 0; padding: 1rem; }
    header { background-color: #003300; text-align: center; padding: 1rem; border-radius: 6px; }
    h1, h2 { margin: 0.5rem 0; }
    .titulo { color: #7fff7f; font-size: 2rem; }
    .frase { color: #b0ffb0; font-size: 1rem; }
    .autor { color: #99cc99; font-size: 0.8rem; }
    .container { display: flex; flex-wrap: wrap; gap: 1rem; }
    .section { background: #1a1a1a; border: 1px solid #2e7d32; border-radius: 6px; padding: 1rem; flex: 1 1 300px; }
    label, input, select, button { display: block; width: 100%; margin: 0.5rem 0; font-size: 0.9rem; }
    input, select { background-color: #111; color: #e0ffe0; border: 1px solid #55cc55; border-radius: 4px; padding: 0.5rem; }
button {
  background-color: #7fff7f;
  color: #000;
  font-weight: bold;
  font-size: 0.75rem;          /* Texto mÃ¡s pequeÃ±o */
  padding: 0.3rem 0.6rem;      /* Menor alto y ancho interno */
  border: none;
  border-radius: 4px;
  cursor: pointer;
  width: auto;                /* Asegura que no se extiendan al 100% */
  min-width: 80px;            /* Opcional: mÃ­nimo ancho para no deformarse */
  max-width: 140px;           /* Opcional: para controlar tamaÃ±o */
}

/* Resto del diseÃ±o igual */
canvas {
  background: #fff;
  margin-top: 1rem;
  width: 100%;
  max-width: 600px;
  height: auto;
}

.result {
  margin-top: 0.5rem;
  font-weight: bold;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 0.5rem;
  font-size: 0.85rem;
}

th, td {
  border: 1px solid #2e7d32;
  padding: 0.3rem;
  text-align: center;
}

.tabla-input input {
  width: 100%;
}.linea-extra {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
  align-items: center;
}
.linea-extra select {
  flex: 1;
  background-color: #111;
  color: #e0ffe0;
  border: 1px solid #55cc55;
  border-radius: 4px;
  padding: 0.5rem;
}
.linea-extra input {
  width: 80px;
  background-color: #111;
  color: #e0ffe0;
  border: 1px solid #55cc55;
  border-radius: 4px;
  padding: 0.5rem;
}

/* Estilos para la nueva secciÃ³n */
.toast-alerta {
  font-family: 'Poppins', sans-serif;
  border-radius: 4px;
  padding: 12px 16px;
}

.cargando {
  display: inline-block;
  width: 16px;
  height: 16px;
  border: 3px solid rgba(255,255,255,0.3);
  border-radius: 50%;
  border-top-color: #fff;
  animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Estilos para la tabla de red */
#miRedContainer table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 1rem;
  font-size: 0.85rem;
}

#miRedContainer th, #miRedContainer td {
  border: 1px solid #2e7d32;
  padding: 8px;
  text-align: left;
}

#miRedContainer th {
  background-color: #003300;
  color: #e0ffe0;
}
  </style>
</head>
<body>
<script>
  const claveCorrecta = "HGW-2025-0147";

  const ingreso = prompt(
    "ğŸ” Ingreso exclusivo con contraseÃ±a\n\n" +
    "ğŸ“Œ No compartas este acceso.\n" +
    "ğŸš« Uso exclusivo e intransferible.\n\n" +
    "Por favor, ingresa tu clave:"
  );

  if (ingreso !== claveCorrecta) {
    alert("âŒ ContraseÃ±a incorrecta. Acceso denegado.");
    window.location.href = "https://google.com";
  }
</script>
<header 
style="display: flex; justify-content: center; align-items: center; background-color: #003300; padding: 1rem; border-radius: 6px; position: relative;">
  <!-- ğŸ” Cuadro de usuario, pegado arriba a la izquierda -->
  <div style="position: absolute; top: 10px; left: 10px; background-color: #111; color: #b6ffb6; font-size: 11px; font-family: 'Poppins', sans-serif; border: 1px solid #44cc44; border-radius: 6px; padding: 6px 10px; max-width: 200px; box-shadow: 0 0 4px #33cc33;">
    <strong>ğŸ” Usuario:</strong> Keren Atencio<br>
    <strong>ğŸ”‘ CÃ³digo:</strong> HGW-2025-0147<br>
    <hr style="border: 0; border-top: 1px solid #44cc44; margin: 4px 0;">
    ğŸ“Œ No compartas este acceso.<br>
    ğŸš« Uso exclusivo e intransferible.
  </div>

  <!-- ğŸ“ˆ TÃ­tulo centrado -->
  <div style="text-align: center;">
    <h1 class="titulo" style="margin: 0; color: #7fff7f;">ğŸ“ˆ Simulador HGW</h1>
    <p class="frase" style="margin: 0.3rem 0; color: #b0ffb0;">Transforma tu red en resultados reales ğŸš€</p>
  </div>
</header> 
</script>
</div>

  <div class="container">
    <div class="section">
      <h2>ğŸ§¾ Registro Red</h2>
      <table class="tabla-input">
        <thead>
          <tr><th>ID</th><th>Nombre</th><th>MembresÃ­a</th><th>Rol</th><th>TelÃ©fono</th></tr>
        </thead>
        <tbody id="tablaRed"></tbody>
      </table>
      <button onclick="agregarFila()">Agregar fila</button>
      <button onclick="descargarExcel()">ğŸ“¥ Descargar Excel</button>
      <button onclick="limpiarTabla()">ğŸ§¹ Limpiar Tabla</button>	
    </div>

    <div class="section">
      <h2>ğŸ’° Bono Inicio RÃ¡pido</h2>
      <label>MembresÃ­a:</label>
      <select id="inicioMembresia">
        <option value="50">50 BV</option>
        <option value="100">100 BV</option>
        <option value="300">300 BV</option>
        <option value="600">600 BV</option>
      </select>
      <label>NÃºmero de Afiliados:</label>
      <input type="number" id="inicioAfiliados" value="0" />
      <button onclick="calcularInicio()">Calcular</button>
      <div class="result">Ganancia Inicio RÃ¡pido: <span id="resInicio"></span></div>
    </div>

    <div class="section">
      <h2>ğŸ› Bono Venta al PÃºblico</h2>
      <label>Monto de Venta (COP):</label>
      <input type="number" id="ventaMonto" value="0" />
      <label>% de Ganancia:</label>
      <select id="ventaPorcentaje">
        <option value="30">30%</option>
        <option value="50">50%</option>
      </select>
      <button onclick="calcularVenta()">Calcular</button>
      <div class="result">Ganancia Venta: <span id="resVenta"></span></div>
    </div>

    <div class="section">
      <h2>ğŸ” Bono Recompra</h2>
      <label>Cantidad de BV:</label>
      <input type="number" id="recompraBV" value="0" />
      <button onclick="calcularRecompra()">Calcular</button>
      <div class="result">Ganancia Recompra: <span id="resRecompra"></span></div>
    </div>

<div class="section">
  <h2>ğŸ“š Bono Desarrollo</h2>
  <label>Selecciona tu membresÃ­a:</label>
  <select id="membresiaDesarrollo">
    <option value="0.2">PreJr</option>
    <option value="0.5">Jr</option>
    <option value="1.5">Sr</option>
    <option value="3.0">Mst</option>
  </select>

  <label>BV de primera compra:</label>
  <input type="number" id="bvDesarrollo" value="0" />

  <label>Â¿Agregar lÃ­neas adicionales?</label>
  <select id="usarExtrasDesarrollo" onchange="toggleExtrasDesarrollo()">
    <option value="no">No</option>
    <option value="si">SÃ­</option>
  </select>

  <div id="extrasDesarrollo" style="display: none; margin-top: 1rem;">
    <h3 style="margin: 0.5rem 0; font-size: 1rem;">LÃ­neas Adicionales</h3>
    <div class="linea-extra">
      <select class="membresia-extra">
        <option value="50">50 BV</option>
        <option value="100">100 BV</option>
        <option value="300">300 BV</option>
        <option value="600">600 BV</option>
      </select>
      <input type="number" class="cantidad-extra" placeholder="Cantidad" value="0" min="0">
    </div>
    <div class="linea-extra">
      <select class="membresia-extra">
        <option value="50">50 BV</option>
        <option value="100">100 BV</option>
        <option value="300">300 BV</option>
        <option value="600">600 BV</option>
      </select>
      <input type="number" class="cantidad-extra" placeholder="Cantidad" value="0" min="0">
    </div>
    <div class="linea-extra">
      <select class="membresia-extra">
        <option value="50">50 BV</option>
        <option value="100">100 BV</option>
        <option value="300">300 BV</option>
        <option value="600">600 BV</option>
      </select>
      <input type="number" class="cantidad-extra" placeholder="Cantidad" value="0" min="0">
    </div>
    <div class="linea-extra">
      <select class="membresia-extra">
        <option value="50">50 BV</option>
        <option value="100">100 BV</option>
        <option value="300">300 BV</option>
        <option value="600">600 BV</option>
      </select>
      <input type="number" class="cantidad-extra" placeholder="Cantidad" value="0" min="0">
    </div>
  </div>

  <button onclick="calcularDesarrollo()">Calcular</button>
  <div class="result">Ganancia Desarrollo: <span id="resDesarrollo"></span></div>
  <div class="result">BV Totales: <span id="bvTotales"></span></div>
  <small><em>FÃ³rmula: ((BV + adicionales) Ã— factor Ã— 3800) Ã· 2</em></small>
</div>

    <div class="section">
      <h2>ğŸ¤ Bono Equipo</h2>
      <label>BV LÃ­nea 1:</label>
      <input type="number" id="bv1Equipo" value="0" />
      <label>BV LÃ­nea 2:</label>
      <input type="number" id="bv2Equipo" value="0" />
      <label>% de Rango:</label>
      <select id="porcentajeEquipo">
        <option value="0.05">PreJr 5%</option>
        <option value="0.07">Jr 7%</option>
        <option value="0.08">Sr 8%</option>
        <option value="0.10">Mst 10%</option>
      </select>
      <button onclick="calcularEquipo()">Calcular</button>
      <div class="result">Ganancia Equipo: <span id="resEquipo"></span></div>
      <small><em>FÃ³rmula: ((min(BV1, BV2) * 10%) / 2) * % rango * 3800</em></small>
    </div>

    <!-- Resultado y grÃ¡fica final -->
    <div class="section">
      <h2>ğŸ“Š Resultados Totales</h2>
      <button onclick="calcularTotales()">ğŸ“Œ Calcular Totales</button>
      <button onclick="limpiarCampos()">ğŸ§¹ Limpiar</button>
      <button onclick="guardarTotales()">ğŸ’¾ Guardar DÃ­a/Mes</button>
      <button onclick="descargarCSV()">ğŸ“¤ Descargar CSV</button>
      <div class="result">Total Diario: <span id="totalDiario"></span></div>
      <div class="result">Acumulado Mensual: <span id="totalMensual"></span></div>
      <canvas id="graficoBonos"></canvas>
    </div>
  </div>

<!-- Agrega esto en la secciÃ³n de pestaÃ±as, justo despuÃ©s del div con class="tab" -->
<div class="tab">
    <button class="tablinks active" onclick="openTab(event, 'dataEntry')">ğŸ§¾ Registro Red</button>
    <button class="tablinks" onclick="openTab(event, 'bonos')">ğŸ’° Bonos</button>
    <button class="tablinks" onclick="openTab(event, 'comisionesRed')">ğŸ“Š Comisiones y Red</button>
    <button class="tablinks" onclick="openTab(event, 'resultados')">ğŸ“ˆ Resultados</button>
</div>

<!-- Agrega esta nueva pestaÃ±a despuÃ©s de las secciones existentes -->
<div id="comisionesRed" class="tabcontent">
    <h2>ğŸ“Š Comisiones y Red</h2>
    
    <div class="section">
        <h3>ğŸ” Mi Red</h3>
        <div class="form-group">
            <label for="userIdRed">Mi ID de Usuario:</label>
            <input type="text" id="userIdRed" required>
        </div>
        <button onclick="cargarMiRed()">Cargar Mi Red</button>
        <div id="miRedContainer" style="margin-top: 1rem;"></div>
    </div>
    
    <div class="section">
        <h3>ğŸ“ Registrar Comisiones</h3>
        <div class="form-group">
            <label for="redMembresia">Mi MembresÃ­a:</label>
            <select id="redMembresia" required>
                <option value="PJ">Pre-Junior</option>
                <option value="J">Junior</option>
                <option value="S">Senior</option>
                <option value="M">Master</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="redSponsorLevel">MembresÃ­a del Patrocinador:</label>
            <select id="redSponsorLevel" required>
                <option value="PJ">Pre-Junior</option>
                <option value="J">Junior</option>
                <option value="S">Senior</option>
                <option value="M">Master</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="redBv1">BV LÃ­nea 1:</label>
            <input type="number" id="redBv1" min="0" step="1" value="0">
        </div>
        
        <div class="form-group">
            <label for="redBv2">BV LÃ­nea 2:</label>
            <input type="number" id="redBv2" min="0" step="1" value="0">
        </div>
        
        <div class="form-group">
            <label for="redVentas">Ventas al PÃºblico (USD):</label>
            <input type="number" id="redVentas" min="0" step="0.01" value="0">
        </div>
        
        <div class="form-group">
            <label for="redFecha">Fecha:</label>
            <input type="date" id="redFecha" required>
        </div>
        
        <button onclick="registrarComisiones()">Registrar Comisiones</button>
        <button onclick="analizarRed()">Analizar Mi Red</button>
    </div>
    
    <div class="section">
        <h3>ğŸ“Š AnÃ¡lisis de Red</h3>
        <div id="analisisRedContainer">
            <p>Selecciona "Analizar Mi Red" para ver estadÃ­sticas</p>
        </div>
        <canvas id="graficoRed"></canvas>
    </div>
</div>

<script>
let totales = { inicio: 0, venta: 0, recompra: 0, desarrollo: 0, equipo: 0 };
let historial = [];

function agregarFila() {
  const tabla = document.getElementById('tablaRed');
  const fila = document.createElement('tr');
  for (let i = 0; i < 5; i++) {
    const td = document.createElement('td');
    const input = document.createElement('input');
    td.appendChild(input);
    fila.appendChild(td);
  }
  tabla.appendChild(fila);
}

function descargarExcel() {
  const filas = [['ID','Nombre','MembresÃ­a','Rol','TelÃ©fono']];
  document.querySelectorAll('#tablaRed tr').forEach(tr => {
    const row = [];
    tr.querySelectorAll('input').forEach(input => row.push(input.value));
    filas.push(row);
  });
  const wb = XLSX.utils.book_new();
  const ws = XLSX.utils.aoa_to_sheet(filas);
  XLSX.utils.book_append_sheet(wb, ws, 'Red HGW');
  XLSX.writeFile(wb, 'registro_hgw.xlsx');
}

function limpiarTabla() {
  const tabla = document.getElementById('tablaRed');
  tabla.innerHTML = '';
}

function calcularInicio() {
  const bv = parseFloat(document.getElementById('inicioMembresia').value);
  const afiliados = parseInt(document.getElementById('inicioAfiliados').value);
  const total = afiliados * bv * 0.10 * 3800;
  totales.inicio = total;
  document.getElementById('resInicio').innerText = `$${total.toLocaleString()}`;
}

function calcularVenta() {
  const monto = parseFloat(document.getElementById('ventaMonto').value);
  const porcentaje = parseFloat(document.getElementById('ventaPorcentaje').value);
  const total = monto * (porcentaje / 100);
  totales.venta = total;
  document.getElementById('resVenta').innerText = `$${total.toLocaleString()}`;
}

function calcularRecompra() {
  const bv = parseFloat(document.getElementById('recompraBV').value);
  const total = bv * 0.025 * 3800;
  totales.recompra = total;
  document.getElementById('resRecompra').innerText = `$${total.toLocaleString()}`;
}

function toggleExtrasDesarrollo() {
  const val = document.getElementById('usarExtrasDesarrollo').value;
  document.getElementById('extrasDesarrollo').style.display = val === 'si' ? 'block' : 'none';
}

function toggleExtrasDesarrollo() {
  const val = document.getElementById('usarExtrasDesarrollo').value;
  document.getElementById('extrasDesarrollo').style.display = val === 'si' ? 'block' : 'none';
}

function calcularDesarrollo() {
  const bv = parseFloat(document.getElementById('bvDesarrollo').value) || 0;
  const factor = parseFloat(document.getElementById('membresiaDesarrollo').value);
  let totalBV = bv;
  let detalles = [];

  if (document.getElementById('usarExtrasDesarrollo').value === 'si') {
    const lineas = document.querySelectorAll('.linea-extra');
    lineas.forEach((linea, index) => {
      const bvLinea = parseFloat(linea.querySelector('.membresia-extra').value);
      const cantidad = parseFloat(linea.querySelector('.cantidad-extra').value) || 0;
      if (cantidad > 0) {
        const subtotal = bvLinea * cantidad;
        totalBV += subtotal;
        detalles.push(`LÃ­nea ${index+1}: ${cantidad} Ã— ${bvLinea}BV = ${subtotal}BV`);
      }
    });
  }

  const total = (totalBV * factor * 3800) / 2;
  totales.desarrollo = total;
  
  document.getElementById('resDesarrollo').innerText = `$${total.toLocaleString()}`;
  document.getElementById('bvTotales').innerText = `${totalBV} BV`;
  
  if (detalles.length > 0) {
    console.log("Detalle de cÃ¡lculo:");
    detalles.forEach(d => console.log(d));
    console.log(`Total BV: ${totalBV} BV`);
    console.log(`Factor membresÃ­a: ${factor}`);
    console.log(`CÃ¡lculo final: (${totalBV} Ã— ${factor} Ã— 3800) Ã· 2 = $${total}`);
  }
}

function calcularEquipo() {
  const bv1 = parseFloat(document.getElementById('bv1Equipo').value);
  const bv2 = parseFloat(document.getElementById('bv2Equipo').value);
  const porcentaje = parseFloat(document.getElementById('porcentajeEquipo').value);
  const base = (Math.min(bv1, bv2) * 0.10) / 2;
  const total = base * porcentaje * 3800;
  totales.equipo = total;
  document.getElementById('resEquipo').innerText = `$${total.toLocaleString()}`;
}

function calcularTotales() {
  const total = Object.values(totales).reduce((a,b)=>a+b,0);
  historial.push(total);
  const mensual = historial.reduce((a,b)=>a+b,0);
  document.getElementById('totalDiario').innerText = `$${total.toLocaleString()}`;
  document.getElementById('totalMensual').innerText = `$${mensual.toLocaleString()}`;
  graficar();
}

function limpiarCampos() {
  document.querySelectorAll('input').forEach(el=>el.value=0);
  document.querySelectorAll('.result span').forEach(el=>el.innerText='');
  Object.keys(totales).forEach(k=>totales[k]=0);
}

function guardarTotales() {
  alert('Guardado en historial diario ğŸ§ ');
}

function descargarCSV() {
  const csv = 'Bono,Valor\n' + Object.entries(totales).map(([k,v])=>`${k},${v}`).join('\n');
  const blob = new Blob([csv], {type: 'text/csv'});
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = 'bonos_totales.csv';
  link.click();
}

function graficar() {
  const ctx = document.getElementById('graficoBonos').getContext('2d');
  if (window.chartHGW) window.chartHGW.destroy();
  window.chartHGW = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: Object.keys(totales),
      datasets: [
        {
          label: 'COP por Bono',
          data: Object.values(totales),
          backgroundColor: '#66ff66'
        },
        {
          type: 'line',
          label: 'Crecimiento acumulado',
          data: Object.values(totales),
          borderColor: '#ffff00',
          borderWidth: 2,
          fill: false
        }
      ]
    },
    options: { responsive: true, plugins: { legend: { position: 'top' } } }
  });
  const nombreUsuario = "Keren Atencio"; // puedes sustituirlo dinÃ¡micamente
  const codigoUnico = "HGW-2025-0147";   // clave asignada Ãºnica para cada usuario
}

// ConfiguraciÃ³n Global
const CONFIG = {
  WEB_APP_URL: "https://script.google.com/macros/s/TU_ID_DE_APP/exec",
  SHEET_ID: "12IYzbZ1pP8vQhLhnBq-YsSfcI5ErDqKo",
  API_KEY: "HGW#2025$14-7kXyZ*9PqW3ert5vBn8n" // Para mayor seguridad
};

// ================== FUNCIONES PARA GITHUB PAGES ================== //

// FunciÃ³n mejorada para llamar a Google Apps Script
async function callGoogleScript(functionName, data = {}) {
  // AÃ±ade seguridad adicional
  data.apiKey = CONFIG.API_KEY;
  data.sheetId = CONFIG.SHEET_ID;
  
  // Usamos URLSearchParams para evitar problemas con CORS
  const params = new URLSearchParams();
  params.append('function', functionName);
  params.append('data', JSON.stringify(data));
  
  try {
    const response = await fetch(`${CONFIG.WEB_APP_URL}?${params.toString()}`, {
      method: 'GET', // Usamos GET por las restricciones de GitHub Pages
      mode: 'cors',
      cache: 'no-cache'
    });
    
    if (!response.ok) throw new Error(`Error HTTP: ${response.status}`);
    return await response.json();
  } catch (error) {
    console.error('Error en callGoogleScript:', error);
    throw new Error(`No se pudo conectar con el servidor. Error: ${error.message}`);
  }
}

// ================== FUNCIONES DE COMISIONES/RED ================== //

// FunciÃ³n para cargar la red (adaptada a GitHub Pages)
async function cargarMiRed() {
  if (!validarSesion()) return;
  
  const userId = document.getElementById('userIdRed').value.trim();
  if (!userId) {
    mostrarAlerta(âš ï¸ Ingresa tu ID de usuario');
    return;
  }

  mostrarCarga(true, 'btnCargarRed');
  
  try {
    const response = await callGoogleScript('getMiRed', { userId });
    
    if (response.error) {
      mostrarAlerta(response.message);
      return;
    }

    // Procesar y mostrar datos...
    renderizarTablaRed(response.data);
    
  } catch (error) {
    mostrarAlerta(error.message);
  } finally {
    mostrarCarga(false, 'btnCargarRed');
  }
}

// FunciÃ³n para registrar comisiones
async function registrarComisiones() {
  if (!validarSesion()) return;
  
  const formData = {
    userId: document.getElementById('userIdRed').value.trim(),
    membresia: document.getElementById('redMembresia').value,
    sponsorLevel: document.getElementById('redSponsorLevel').value,
    bv1: parseFloat(document.getElementById('redBv1').value) || 0,
    bv2: parseFloat(document.getElementById('redBv2').value) || 0,
    ventas: parseFloat(document.getElementById('redVentas').value) || 0,
    fecha: document.getElementById('redFecha').value
  };

  // ValidaciÃ³n mejorada
  if (!formData.userId || !formData.fecha) {
    mostrarAlerta('âŒ Completa todos los campos obligatorios');
    return;
  }

  mostrarCarga(true, 'btnRegistrarComisiones');
  
  try {
    const response = await callGoogleScript('registrarComisionesRed', formData);
    
    if (response.success) {
      mostrarAlerta('âœ… Comisiones registradas correctamente', 'success');
      // Limpiar formulario
      ['redBv1', 'redBv2', 'redVentas'].forEach(id => document.getElementById(id).value = '');
    } else {
      mostrarAlerta(`âŒ ${response.message}`);
    }
  } catch (error) {
    mostrarAlerta(`ğŸš¨ Error: ${error.message}`);
  } finally {
    mostrarCarga(false, 'btnRegistrarComisiones');
  }
}

// ================== FUNCIONES AUXILIARES ================== //

// FunciÃ³n para validar sesiÃ³n (basada en tu contraseÃ±a existente)
function validarSesion() {
  const claveGuardada = sessionStorage.getItem('hgwAuth');
  if (!claveGuardada || claveGuardada !== "HGW-2025-0147") {
    window.location.href = "https://google.com";
    return false;
  }
  return true;
}

// FunciÃ³n para mostrar alertas estilizadas
function mostrarAlerta(mensaje, tipo = 'error') {
  const colores = {
    success: '#4CAF50',
    error: '#f44336',
    warning: '#ff9800'
  };
  
  Toastify({
    text: mensaje,
    duration: 3000,
    backgroundColor: colores[tipo] || colores.error,
    className: "toast-alerta"
  }).showToast();
}

// FunciÃ³n para mostrar/ocultar carga
function mostrarCarga(mostrar, elementoId) {
  const btn = document.getElementById(elementoId);
  if (btn) {
    btn.disabled = mostrar;
    btn.innerHTML = mostrar ? 
      '<span class="cargando"></span> Procesando...' : 
      btn.getAttribute('data-texto-original');
  }
}

// InicializaciÃ³n
document.addEventListener('DOMContentLoaded', function() {
  // Configura fecha actual
  document.getElementById('redFecha').value = new Date().toISOString().split('T')[0];
  
  // Guarda texto original de botones
  document.querySelectorAll('button').forEach(btn => {
    btn.setAttribute('data-texto-original', btn.textContent);
  });
  
  // Verifica autenticaciÃ³n
  validarSesion();
});


</script>
</body>
<footer style="text-align: center; background-color: #003300; color: #e0ffe0; font-family: 'Poppins', sans-serif; font-size: 12px; padding: 1rem; margin-top: 2rem; border-radius: 6px;">
  <div><strong>Modelo:</strong> SimHGW1</div>
  <div><strong>ğŸŒCorreo electronico:</strong> pibvaliu@gmail.com</div>
  <a href="https://wa.me/573135727768?text=Hola%2C%20necesito%20ayuda%20con%20el%20simulador" target="_blank">
  ğŸ’¬ Contactar vÃ­a WhatsApp
</a>
  <div><strong>ğŸ› ï¸Soporte tÃ©cnico:</strong> 3135727768 (palabra clave: <em>soport</em>)</div>
  <div><strong>Â©Derechos de autor:</strong> DataCaval</div>
  <div><strong>ğŸ“UbicaciÃ³n:</strong> Valledupar/20</div>
</footer>
</html>